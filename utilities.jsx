/* * Get the Bounds of an art layer * It first try to rasterize the layer because rasterize is faster. * If this layer cannot be rastierized, it will flatten it. */function GetTheBounds (ThisTestLayer){    try {        activeDocument.activeLayer = ThisTestLayer        ThisTestLayer.rasterize(RasterizeType.ENTIRELAYER)        var TheBounds = activeDocument.activeLayer.bounds    } catch (e) {        var TempOriginalDoc = activeDocument        var TempOrigWidth = TempOriginalDoc.width        var TempOrigHeight = TempOriginalDoc.height        var EphemeralDoc = documents.add(            TempOrigWidth,             TempOrigHeight,             72,             "TempFlattener",             NewDocumentMode.RGB,             DocumentFill.TRANSPARENT        )        activeDocument = TempOriginalDoc        WaitForRedraw()        ThisTestLayer.duplicate(EphemeralDoc, ElementPlacement.PLACEATBEGINNING)        activeDocument = EphemeralDoc        EphemeralDoc.mergeVisibleLayers        EphemeralDoc.crop(new Array(0, 0, TempOrigWidth, TempOrigHeight), undefined, TempOrigWidth, TempOrigHeight)        var TheBounds = EphemeralDoc.layers[0].bounds        EphemeralDoc.close(SaveOptions.DONOTSAVECHANGES)        activeDocument = TempOriginalDoc    }        return (TheBounds)}/* * Wait Photoshop to draw before next action * If not calling this function, active document might be wrong */function WaitForRedraw() {    return;    var eventWait = charIDToTypeID("Wait")    var enumRedrawComplete = charIDToTypeID("RdCm")    var typeState = charIDToTypeID("Stte")    var keyState = charIDToTypeID("Stte")    var desc = new ActionDescriptor()    desc.putEnumerated(keyState, typeState, enumRedrawComplete)    executeAction(eventWait, desc, DialogModes.NO)}/* * get the layers with name "ALT PAGE" * usually found in DVD with mulit-pages or episodes * */function getAltPageList(ThisDoc){    var list = new Array();	for (var i = 0; i < ThisDoc.layers.length; i++) {		if (ThisDoc.layers[i].name.indexOf("ALT PAGE") != -1) {			list.push( ThisDoc.layers[i].name);		}		// alert ("TiffAltPagesList " + TiffAltPagesList)	}    return list;}function getForAllPageList(ThisDoc){    var list = new Array();	for (var i = 0; i < ThisDoc.layers.length; i++) {		if (ThisDoc.layers[i].name.indexOf("FOR ALL") != -1) {			list.push( ThisDoc.layers[i].name);		}		// alert ("TiffAltPagesList " + TiffAltPagesList)	}    return list;}/* * Found language pages like "en", "it", "es"... * Exclude GUIDES, TOYBOX... */function getAllMenu(ThisDoc){    var menuSets = new Array();    for (var i = 0; i < ThisDoc.layers.length; i++) {	    var layerName = ThisDoc.layers[i].name;		if (            layerName != "GUIDES" &&             layerName != "TOYBOX" &&             layerName != "BACKGROUND IMAGE" &&             layerName != "FOR ALL LANGS" &&             layerName.indexOf("ALT PAGE") == -1 &&            layerName.indexOf("FOR ALL") == -1         ) {			menuSets.push (layerName);		}	}    return menuSets;}function bounds_trim(ary){        return new Array (            parseInt(ary[0],10),            parseInt(ary[1],10),            parseInt(ary[2],10),            parseInt(ary[3],10)        );}